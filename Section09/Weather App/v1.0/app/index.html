<!doctype html><html lang="en" ng-app="weatherApp"><head>  <meta charset="utf-8">  <title>Weather App</title>  <link rel="stylesheet" href="css/bootstrap.min.css">  <link rel="stylesheet" href="css/bootstrap-theme.min.css">  <link rel="stylesheet" href="css/custom.css">  <script src="js/jquery.min.js"></script>  <script src="js/bootstrap.min.js"></script>  <script src="js/highcharts.js"></script>  <script src="js/angular.js"></script>  <script src="js/angular-route.js"></script>    <script>		(function() {		var name = "weatherApp",			requires = ['ngRoute'],			weatherApp = null;				weatherApp = angular.module(name, requires);				weatherApp.value("appID", "6bae81d5385bddc087bd48e634349955");		weatherApp.value("weatherImgUrl", "http://openweathermap.org/img/w/");		weatherApp.value("openWeatherUrl", "http://api.openweathermap.org/data/2.5/weather");		weatherApp.value("openForecastUrl", "http://api.openweathermap.org/data/2.5/forecast/daily");				weatherApp.service("commonSvc", function() {			var timezone = 1000 * (new Date().getTimezoneOffset())*(-60);						this.getTemp = getTemp;			this.getTime = getTime;						function getTemp(temp) {				return Math.round(temp - 273.15);			}						function getTime(dt) {				return new Date(dt*1000 + timezone);			}		});				weatherApp.factory("weatherSvc", function($http, $q, openWeatherUrl, openForecastUrl) {						return {				getCurrent: function(location) {					var defer = $q.defer();					var url = openWeatherUrl + "?q=" + location;										$http.get(url).success(getCurrentSuccess).error(getCurrentError);										function getCurrentSuccess(data) {						defer.resolve(data);					}										function getCurrentError(err) {						defer.reject(err);					}										return defer.promise;				},								getForecast: function(location, days) {					var defer = $q.defer();					var url = openForecastUrl + "?q=" + location + "&cnt=" + days;										$http.get(url).success(getForecastSuccess).error(getForecastError);										function getForecastSuccess(data) {						defer.resolve(data);					}										function getForecastError(err) {						defer.reject(err);					}										return defer.promise;				}			}		});				weatherApp.controller("SearchCtrl", function($scope, weatherSvc, weatherImgUrl, commonSvc) {			$scope.current = null;			$scope.forecast = null;			$scope.search = search;			$scope.getWeatherImgUrl = getWeatherImgUrl;			$scope.getTemp = commonSvc.getTemp;			$scope.getTime = commonSvc.getTime;						function search(location) {				weatherSvc.getCurrent(location)					.then(						function(response) {							$scope.current = response;							console.log($scope.current);						},						function(err) {							console.log("Error: ", err);						}					);								weatherSvc.getForecast(location, 10)					.then(						function(response) {							$scope.forecast = response;							console.log("Forecast: ", $scope.forecast);						},						function(err) {							console.log("Error: ", err);						}					);			}						function getWeatherImgUrl(url) {				return weatherImgUrl + url + ".png";			}		});				weatherApp.config(function($routeProvider) {									});				weatherApp.directive("edgzyForecast", function(commonSvc) {			return {				restrict: "AE",				replace: true,				scope: {					dp:"="				},				template: "<div id='container'></div>",				link: linkFn			}						function linkFn(scope, element, attrs) {				var options = {					chart: {						zoomType: 'xy'					},					title: {						text: 'Weather Dashboard'					},					xAxis: {						type: 'datetime',						labels: {							formatter: function() {								return Highcharts.dateFormat('%d %b', this.value);							}							}					},					yAxis: [{ // Primary yAxis						labels: {							format: '{value}°C',							style: {								color: Highcharts.getOptions().colors[1]							}						},						title: {							text: 'Temperature',							style: {								color: Highcharts.getOptions().colors[1]							}						}					}, { // Secondary yAxis						title: {							text: 'Speed',							style: {								color: Highcharts.getOptions().colors[0]							}						},						labels: {							format: '{value} m/s',							style: {								color: Highcharts.getOptions().colors[0]							}						},						opposite: true					}],					tooltip: {						useHTML: true,						shared: true,						formatter: function() {							var s = '<small>'+ Highcharts.dateFormat('%d %b', this.x) +'</small><table>';							$.each(this.points, function(i, point) {								//console.log(point);									if(point.y != 0)										s += '<tr><td style="color:'+point.series.color+'">'+ point.series.name +': </td>'+										'<td style="text-align: right"><b>'+point.y +'</b></td></tr>';							}							);							return s+'</table>';						}					},					legend: {						layout: 'vertical',						align: 'left',						x: 120,						verticalAlign: 'top',						y: 100,						floating: true,						backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'					},					series: [{						name: 'Speed',						type: 'column',						yAxis: 1,						tooltip: {							valueSuffix: ' m/s'						}					}, {						name: 'Temperature',						type: 'spline',						tooltip: {							valueSuffix: '°C'						}					}]				}											scope.$watch('dp', onDPChange);								function onDPChange(newDP) {					if (newDP) {						initOptions(newDP);											render();					}				}								function initOptions(dp) {					var data;					var time = [];					var temp = [];					var speed = [];										for (var i = 0; i < dp.list.length; i++) {						data = dp.list[i];						time.push(commonSvc.getTime(data.dt));						temp.push(commonSvc.getTemp(data.temp.day));						speed.push(data.speed);					}										options.title.text = "Weather Forecast for " + dp.city.name + ", " + dp.city.country;					options.xAxis.categories = time;					options.series[1].data = temp;					options.series[0].data = speed;										console.log(options);				}								function render() {					element.highcharts(options);				}			}		});	}());	  </script></head><body>	<nav class="navbar navbar-default">		<div class="container-fluid">			<div class="navbar-header">			  <a class="navbar-brand" href="#">				Weather Dashboard			  </a>			</div>		</div>	</nav>		<div class="container-fluid" ng-controller="SearchCtrl">			<div class="row">			<form class="form-inline col-md-12">				<div class="form-group">					<input type="text" class="form-control" id="searchInput" 						placeholder="Enter City" ng-model="location">					<button class="btn btn-info" ng-click="search(location)">Search</button>				</div>			</form>		</div>		<div class="row">			<div class="col-md-11 well weather-current">				<div>					<h2>{{current.name}}</h2>					<ul class="list-inline">						<li><img ng-src="{{getWeatherImgUrl(current.weather[0].icon)}}" /></li>						<li><h2>{{getTemp(current.main.temp)}} &#8451;</h2></li>					</ul>					<h4>{{current.weather[0].main}}</h4>					<p>Got at: {{getTime(current.dt) | date: 'yyyy-MMM-dd HH:mm'}}</p>					<div class="col-md-4">						<table class="table table-striped table-bordered table-condensed">							<tbody>								<tr>									<td>Wind</td>									<td>Speed {{current.wind.speed}} m/s</td>								</tr>								<tr>									<td>Cloudiness</td>									<td>{{current.weather[0].description}}</td>								</tr>								<tr>									<td>Pressure</td>									<td>{{current.main.pressure}} hpa</td>								</tr>								<tr>									<td>Humidity</td>									<td>{{current.main.humidity}} %</td>								</tr>								<tr>									<td>Sunrise</td>									<td>{{getTime(current.sys.sunrise) | date: 'HH:mm'}}</td>								</tr>								<tr>									<td>Sunset</td>									<td>{{getTime(current.sys.sunset) | date: 'HH:mm'}}</td>								</tr>								<tr>									<td>Geo coords</td>									<td>[{{current.coord.lon}}, {{current.coord.lat}}]</td>								</tr>							</tbody>						</table>					</div>				</div>				</div>		</div>				<div class="row">			<h3>Future Forecast</h3>			<div class="col-md-4">				<table class="table">					<tbody>						<tr ng-repeat="weather in forecast.list">							<td>{{getTime(weather.dt) | date: "dd MMM"}} <img src="{{getWeatherImgUrl(weather.weather[0].icon)}}"></td>							<td>								<span class="label label-warning">{{getTemp(weather.temp.max)}}°C</span>&nbsp;								<span class="label label-default">{{getTemp(weather.temp.min)}}°C</span> &nbsp;&nbsp;								<i>{{weather.weather[0].description}}</i> 								<p>{{weather.speed}} m/s <br>								clouds: {{weather.clouds}}%, {{weather.pressure}} hpa</p>							</td>						</tr>					</tbody>				</table>			</div>		</div>				<div class="row">			<div class="col-md-12">				<edgzy-forecast dp="forecast"></edgzy-forecast>			</div>		</div>	</div></body></html>