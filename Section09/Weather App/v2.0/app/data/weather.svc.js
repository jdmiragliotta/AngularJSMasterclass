(function() {	angular.module("app.data")		.factory("weatherSvc", function($http, $q, weatherSvcUrl, weatherImgUrl, countryFlagImgUrl) {			return {				find: findByLocation,				getWeatherImgUrl: getWeatherImgUrl,				getCountryFlagImgUrl: getCountryFlagImgUrl,				getTempInDegree: getTempInDegree,				getCurrent: getCurrentWeather,				getTime: getTime,				getForecast: getForecast			}						function findByLocation(location) {				var defer = $q.defer();								$http.get(weatherSvcUrl+"find?"+"q="+location+"&type=like&sort=population&cnt=30")					.success(function(response) {						defer.resolve(response);					})					.error(function(err) {						defer.reject(err);					});									return defer.promise;			}						function getWeatherImgUrl(imgStr) {				return weatherImgUrl+imgStr+".png";			}						function getCountryFlagImgUrl(imgStr) {				return countryFlagImgUrl+imgStr.toLowerCase()+".png";			}						function getTempInDegree(temp) {				return Math.round(temp - 273.15);			}						function getCurrentWeather(id) {				var defer = $q.defer();								$http.get(weatherSvcUrl+"weather?"+"id="+id)					.success(function(response) {						defer.resolve(response);					})					.error(function(err) {						defer.reject(err);					});									return defer.promise;			}						function getTime(dt) {				return new Date(dt*1000);			}						function getForecast(id) {					var defer = $q.defer();					var url = weatherSvcUrl + "forecast/daily?id=" + id;										$http.get(url)						.success(function getForecastSuccess(data) {							defer.resolve(data);						})						.error(function getForecastError(err) {							defer.reject(err);						});										return defer.promise;				}		});		}());